# ğŸ” ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç† - å®Ÿè£…å®Œäº†

## âœ… å®Ÿè£…å†…å®¹

### 1. **ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ã®ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†**

Next.jsã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§Supabaseã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å°‚ç”¨ã‚¯ãƒƒã‚­ãƒ¼ã«ä¿å­˜ï¼š

```typescript
// front/src/middleware.ts
if (session?.access_token) {
  response.cookies.set('sb-access-token', session.access_token, {
    httpOnly: true,           // XSSæ”»æ’ƒé˜²æ­¢
    secure: true,             // HTTPS ã®ã¿
    sameSite: 'lax',          // CSRFæ”»æ’ƒé˜²æ­¢
    maxAge: 60 * 60 * 24 * 7, // 7æ—¥é–“
  });
}
```

### 2. **èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°**

ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ç°¡å˜ã«èªè¨¼ã‚’æ‰±ãˆã‚‹é–¢æ•°ã‚’æä¾›ï¼š

```typescript
// front/src/lib/auth/server.ts

// èªè¨¼å¿…é ˆãƒšãƒ¼ã‚¸ã§ä½¿ç”¨ï¼ˆæœªèªè¨¼æ™‚ã¯è‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼‰
await requireAuth();

// ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
const token = await getAccessToken();

// ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å–å¾—
const userId = await getUserId();

// ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å–å¾—
const session = await getSession();
```

### 3. **APIè‡ªå‹•èªè¨¼**

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è‡ªå‹•çš„ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä»˜ä¸ï¼š

```typescript
// front/src/lib/api/server.ts

// å†…éƒ¨ã§è‡ªå‹•çš„ã«ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã—ã¦Authorizationãƒ˜ãƒƒãƒ€ãƒ¼ã«è¿½åŠ 
const user = await getAPI('/api/user/me');
```

## ğŸ“ æ–°è¦ãƒ»æ›´æ–°ãƒ•ã‚¡ã‚¤ãƒ«

### æ–°è¦ä½œæˆ
- âœ… `front/src/lib/auth/server.ts` - èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
- âœ… `front/src/app/profile/page.tsx` - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰
- âœ… `front/MIDDLEWARE_TOKEN_MANAGEMENT.md` - è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### æ›´æ–°
- âœ… `front/src/middleware.ts` - ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚¯ãƒƒã‚­ãƒ¼ã«ä¿å­˜
- âœ… `front/src/lib/api/server.ts` - è‡ªå‹•èªè¨¼æ©Ÿèƒ½
- âœ… `front/src/app/api-example/page.tsx` - ã‚µãƒ³ãƒ—ãƒ«ãƒšãƒ¼ã‚¸æ›´æ–°

## ğŸ¯ ä½¿ã„æ–¹

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: èªè¨¼ãƒã‚§ãƒƒã‚¯ã®ã¿

```typescript
// app/dashboard/page.tsx
import { requireAuth } from '@/lib/auth/server';

export default async function DashboardPage() {
  // æœªèªè¨¼ã®å ´åˆã¯ /login ã¸è‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
  await requireAuth();
  
  return <div>ä¿è­·ã•ã‚ŒãŸãƒšãƒ¼ã‚¸</div>;
}
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—

```typescript
// app/users/page.tsx
import { requireAuth } from '@/lib/auth/server';
import { getAPI } from '@/lib/api/server';
import { UserResponse } from '@/lib/api/types';

export default async function UsersPage() {
  // èªè¨¼ãƒã‚§ãƒƒã‚¯
  await requireAuth();
  
  // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆè‡ªå‹•çš„ã«ãƒˆãƒ¼ã‚¯ãƒ³ãŒä»˜ä¸ã•ã‚Œã‚‹ï¼‰
  const user = await getAPI<UserResponse>('/api/user/me');
  
  return (
    <div>
      <h1>ã“ã‚“ã«ã¡ã¯ã€{user.user.name}ã•ã‚“</h1>
    </div>
  );
}
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: è¤‡æ•°ã®APIã‚’ä¸¦åˆ—ã§å‘¼ã³å‡ºã—

```typescript
// app/dashboard/page.tsx
import { requireAuth } from '@/lib/auth/server';
import { getAPI } from '@/lib/api/server';

export default async function DashboardPage() {
  await requireAuth();
  
  // è¤‡æ•°ã®APIã‚’ä¸¦åˆ—ã§å–å¾—
  const [user, sites, credentials] = await Promise.all([
    getAPI('/api/user/me'),
    getAPI('/api/sites'),
    getAPI('/api/credentials'),
  ]);
  
  return <div>...</div>;
}
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³4: ãƒˆãƒ¼ã‚¯ãƒ³æƒ…å ±ã®å–å¾—

```typescript
// app/debug/page.tsx
import { requireAuth, getAccessToken, getUserId } from '@/lib/auth/server';

export default async function DebugPage() {
  const session = await requireAuth();
  const accessToken = await getAccessToken();
  const userId = await getUserId();
  
  return (
    <div>
      <p>User ID: {userId}</p>
      <p>Email: {session.user.email}</p>
      <p>Token: {accessToken?.substring(0, 20)}...</p>
    </div>
  );
}
```

## ğŸ”„ ãƒ•ãƒ­ãƒ¼å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Next.js Middleware ãŒå®Ÿè¡Œ                                 â”‚
â”‚     â”œâ”€ Supabaseã‚¯ãƒƒã‚­ãƒ¼ã‹ã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³å–å¾—                      â”‚
â”‚     â”œâ”€ session.access_token ã‚’å–å¾—                            â”‚
â”‚     â””â”€ å°‚ç”¨ã‚¯ãƒƒã‚­ãƒ¼(sb-access-token)ã«ä¿å­˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå®Ÿè¡Œ                               â”‚
â”‚     â”œâ”€ requireAuth() ã§èªè¨¼ãƒã‚§ãƒƒã‚¯                           â”‚
â”‚     â”œâ”€ getAccessToken() ã§ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—                        â”‚
â”‚     â””â”€ getAPI() ã§ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå‘¼ã³å‡ºã—                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. fetchAPI() é–¢æ•°å†…ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ã«è¿½åŠ                 â”‚
â”‚     Authorization: Bearer <access_token>                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Go Backend API ãŒ JWT ã‚’æ¤œè¨¼                              â”‚
â”‚     â”œâ”€ ãƒˆãƒ¼ã‚¯ãƒ³ã®ç½²åã‚’ç¢ºèª                                   â”‚
â”‚     â”œâ”€ auth_user_id ã‚’å–å¾—                                    â”‚
â”‚     â””â”€ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½

### ã‚¯ãƒƒã‚­ãƒ¼ä¿è­·

| è¨­å®š | å€¤ | åŠ¹æœ |
|------|-----|------|
| `httpOnly` | `true` | JavaScriptã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ï¼ˆXSSå¯¾ç­–ï¼‰ |
| `secure` | `true` | HTTPSé€šä¿¡ã®ã¿ï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰ |
| `sameSite` | `lax` | CSRFæ”»æ’ƒé˜²æ­¢ |
| `maxAge` | `604800` | 7æ—¥é–“ã®æœ‰åŠ¹æœŸé™ |

### è‡ªå‹•èªè¨¼ãƒã‚§ãƒƒã‚¯

```typescript
// æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªå‹•çš„ã« /login ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
const session = await requireAuth();
```

## ğŸ“Š ãƒ¡ãƒªãƒƒãƒˆ

### 1. **é–‹ç™ºè€…ä½“é¨“ã®å‘ä¸Š**
- âœ… ã‚·ãƒ³ãƒ—ãƒ«ãªAPIï¼š`await requireAuth()` ã ã‘ã§èªè¨¼ãƒã‚§ãƒƒã‚¯
- âœ… è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ï¼šæ‰‹å‹•ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ‰±ã†å¿…è¦ãªã—
- âœ… å‹å®‰å…¨ï¼šTypeScriptã§å®Œå…¨ã«å‹ä»˜ã‘

### 2. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
- âœ… httpOnly ã‚¯ãƒƒã‚­ãƒ¼ã§XSSæ”»æ’ƒã‚’é˜²æ­¢
- âœ… sameSite è¨­å®šã§CSRFæ”»æ’ƒã‚’é˜²æ­¢
- âœ… æœ¬ç•ªç’°å¢ƒã§ã¯ HTTPS ã®ã¿

### 3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**
- âœ… ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§SSR/SSG
- âœ… åˆæœŸè¡¨ç¤ºãŒé«˜é€Ÿ
- âœ… SEOã«æœ‰åˆ©

### 4. **ä¿å®ˆæ€§**
- âœ… ä¸€å…ƒç®¡ç†ï¼šãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç®¡ç†
- âœ… DRYï¼šèªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã‚’å†åˆ©ç”¨
- âœ… ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„æ§‹é€ 

## ğŸ§ª ã‚µãƒ³ãƒ—ãƒ«ãƒšãƒ¼ã‚¸

ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã§å®Ÿè£…ã‚’ç¢ºèªã§ãã¾ã™ï¼š

### `/profile` - ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸
- èªè¨¼ãƒã‚§ãƒƒã‚¯ã®ä¾‹
- ãƒˆãƒ¼ã‚¯ãƒ³æƒ…å ±ã®è¡¨ç¤º
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—
- ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ã®è¡¨ç¤º

### `/api-example` - APIçµ±åˆã‚µãƒ³ãƒ—ãƒ«
- è¤‡æ•°APIã®ä¸¦åˆ—å‘¼ã³å‡ºã—
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º

ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•ï¼š
```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰èµ·å‹•
cd front
npm run dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã
http://localhost:3000/profile
http://localhost:3000/api-example
```

## ğŸ› ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

### 1. ãƒˆãƒ¼ã‚¯ãƒ³ã®ç¢ºèª

```typescript
const accessToken = await getAccessToken();
console.log('Access Token:', accessToken);
```

### 2. ã‚¯ãƒƒã‚­ãƒ¼ã®ç¢ºèª

ãƒ–ãƒ©ã‚¦ã‚¶ã®DevToolsï¼š
1. Application ã‚¿ãƒ–
2. Cookies â†’ `http://localhost:3000`
3. `sb-access-token` ã‚’ç¢ºèª

### 3. JWT ã®å†…å®¹ç¢ºèª

```typescript
const token = await getAccessToken();
if (token) {
  const payload = JSON.parse(
    Buffer.from(token.split('.')[1], 'base64').toString()
  );
  console.log('Token Payload:', payload);
  console.log('User ID:', payload.sub);
  console.log('Expires:', new Date(payload.exp * 1000));
}
```

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- ğŸ“– `front/MIDDLEWARE_TOKEN_MANAGEMENT.md` - è©³ç´°ãªæŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- ğŸ“– `front/SETUP.md` - Supabaseèªè¨¼ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- ğŸ“– `front/BACKEND_SETUP.md` - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµ±åˆã‚¬ã‚¤ãƒ‰
- ğŸ“– `backend/README.md` - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIä»•æ§˜

## âœ¨ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. âœ… ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†
2. âœ… èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
3. âœ… APIè‡ªå‹•èªè¨¼
4. ğŸ”² ãƒˆãƒ¼ã‚¯ãƒ³ã®è‡ªå‹•æ›´æ–°
5. ğŸ”² ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã®å®Ÿè£…
6. ğŸ”² ãƒˆãƒ¼ã‚¯ãƒ³ã®æš—å·åŒ–
7. ğŸ”² ã‚ˆã‚Šè©³ç´°ãªæ¨©é™ç®¡ç†

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### DO âœ…

```typescript
// èªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸
await requireAuth();

// APIå‘¼ã³å‡ºã—ã¯ getAPI() ã‚’ä½¿ç”¨
const data = await getAPI('/api/endpoint');

// è¤‡æ•°APIã¯ä¸¦åˆ—ã§å–å¾—
const [data1, data2] = await Promise.all([
  getAPI('/api/1'),
  getAPI('/api/2'),
]);
```

### DON'T âŒ

```typescript
// âŒ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ‰‹å‹•ã§ç®¡ç†ã—ãªã„
const cookieStore = await cookies();
const token = cookieStore.get('sb-access-token');

// âŒ fetch ã‚’ç›´æ¥ä½¿ç”¨ã—ãªã„ï¼ˆgetAPI ã‚’ä½¿ç”¨ï¼‰
const response = await fetch('/api/endpoint');

// âŒ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§èªè¨¼ãƒã‚§ãƒƒã‚¯ã—ãªã„
// ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ requireAuth() ã‚’ä½¿ç”¨
```

## ğŸ‰ ã¾ã¨ã‚

ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã«ã‚ˆã‚Šã€ä»¥ä¸‹ãŒå®Ÿç¾ã•ã‚Œã¾ã—ãŸï¼š

1. **ç°¡å˜ãªèªè¨¼ãƒã‚§ãƒƒã‚¯** - `await requireAuth()` ã ã‘
2. **è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³ä»˜ä¸** - APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è‡ªå‹•çš„ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¿½åŠ 
3. **ã‚»ã‚­ãƒ¥ã‚¢ãªå®Ÿè£…** - httpOnly ã‚¯ãƒƒã‚­ãƒ¼ã§XSSå¯¾ç­–
4. **é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Š** - èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã®å†åˆ©ç”¨
5. **ä¿å®ˆæ€§ã®å‘ä¸Š** - ä¸€å…ƒç®¡ç†ã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³

ã“ã‚Œã§ã€ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã®çµ±åˆãŒå®Œå…¨ã«å®Œäº†ã—ã¾ã—ãŸï¼

